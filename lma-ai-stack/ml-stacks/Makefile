
VERSION_FILE ?= ../VERSION
AWS_REGION ?= us-east-1
RELEASE_S3_BUCKET := $(RELEASE_S3_BUCKET_BASE)-$(AWS_REGION)
RELEASE_S3_PREFIX ?= release
RELEASE_VERSION ?= $(shell cat $(VERSION_FILE))

BEDROCK_BOTO3_STACK_TEMPLATE := bedrock-preview-boto3-stack.yaml
RELEASE_TEMPLATE_BEDROCK_BOTO3_S3_URL := s3://$(RELEASE_S3_BUCKET)/$(RELEASE_S3_PREFIX)/$(RELEASE_VERSION)/$(BEDROCK_BOTO3_STACK_TEMPLATE)

bedrock-boto3-stack: $(BEDROCK_BOTO3_STACK_TEMPLATE)
	echo '[INFO] uploading $(BEDROCK_BOTO3_STACK_TEMPLATE) to $(RELEASE_TEMPLATE_BEDROCK_BOTO3_S3_URL)'
	aws s3 cp '$(BEDROCK_BOTO3_STACK_TEMPLATE)' '$(RELEASE_TEMPLATE_BEDROCK_BOTO3_S3_URL)'

release: bedrock-boto3-stack
.PHONY: release